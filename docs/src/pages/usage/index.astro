---
import { joinURL } from "ufo";
import { Image } from "astro:assets";

import Layout from "../../layouts/Layout.astro";
import effectFiltersImage from "./effect-filters.png";
import basicPropertiesImage from "./basic-properties.png";
import advancedPropertiesImage from "./advanced-properties.png";

const { BASE_URL } = import.meta.env;
---

<Layout
  lang="en"
  title="How to install?"
  description="Instructions for installing Live Background Removal Lite on various operating systems."
>
  <main class="white-box">
    <h1>Usage</h1>

    <section>
      <h2>Adding the Filter</h2>
      <Image src={effectFiltersImage} alt="Effect Filters" />
      <ol>
        <li>
          In OBS Studio, right-click your video source (e.g., your webcam) in
          the "Sources" panel.
        </li>
        <li>
          Select <strong>Filters</strong> from the context menu.
        </li>
        <li>
          In the "Filters" window, under the "Effect Filters" section, click the
          <strong>+</strong> button to add a new filter.
        </li>
        <li>
          From the list of available filters, select
          <strong>Live Background Removal Lite</strong>.
        </li>
        <li>
          The filter will be added to your source, and you can now adjust its
          properties as needed.
        </li>
      </ol>
    </section>

    <section>
      <h2>Basic Properties</h2>
      <Image src={basicPropertiesImage} alt="Basic Properties" />
      <ul>
        <li>
          <strong>Plugin Status</strong>: The top section displays the current
          update status of the plugin.
        </li>
        <li>
          <strong>Show Debug Window</strong>: Opens the debug view. <br />
          <em
            >Note: Keeping the debug window open significantly increases system
            load. Close it when not in use.</em
          >
        </li>
        <li>
          <strong>Motion Intensity Threshold [dB]</strong>: Determines the
          movement sensitivity to trigger the AI. Lowering this value makes it
          less sensitive (duller) and reduces load. <br />
          <em
            >Tip: Adjust this value as low as possible while maintaining
            accurate mask tracking when you move.</em
          >
        </li>
        <li>
          <strong>Motion Tracking Speed</strong>: Adjusts the filter to suppress
          flickering.
          <ul>
            <li>
              <strong>Lower values</strong>: Less flickering, but increases mask
              latency (lag).
            </li>
            <li>
              <strong>Higher values</strong>: Faster tracking response, but may
              increase flickering.
            </li>
            <li><strong>0</strong>: The mask stops moving.</li>
            <li><strong>1</strong>: Disables the filter completely.</li>
          </ul>
        </li>
      </ul>
    </section>

    <section>
      <h2>Advanced Properties</h2>
      <Image src={advancedPropertiesImage} alt="Advanced Properties" />
      <p>
        To modify the extended configurations, you must enable the <strong
          >Advanced Settings</strong
        > checkbox.<br />
        <em
          >Note: When this checkbox is unchecked, all settings below are forced
          to their default values.</em
        >
      </p>

      <ul>
        <li>
          <strong>Number of Threads</strong>: Specifies the number of CPU
          threads used for processing. A value of <strong>2</strong> is optimal for
          most environments.
        </li>
        <li>
          <strong>Guided Filter Eps [dB]</strong>: Controls the epsilon
          parameter of the Guided Filter. This balances smoothing versus edge
          preservation. Adjust this if fine details look too blurry or noisy.
        </li>
        <li>
          <strong>Mask Gamma</strong>: Controls the edge hardness.
          <ul>
            <li>
              <strong>&gt; 1.0</strong>: Makes edges sharper/thinner (choke).
            </li>
            <li>
              <strong>&lt; 1.0</strong>: Makes edges softer/thicker (spread).
            </li>
            <li><em>Typical value: 1.5 - 2.5</em></li>
          </ul>
        </li>
        <li>
          <strong>Mask Lower Bound [dB]</strong> & <strong
            >Mask Upper Bound Margin [dB]</strong
          >: These parameters prevent ambiguous semi-transparency to improve the
          cutout quality.
          <ul>
            <li>
              <strong>Lower Bound</strong>: Pixels below this level become fully
              transparent. Controls <strong>halo removal</strong>.
            </li>
            <li>
              <strong>Upper Bound Margin</strong>: Pixels above this level
              become fully opaque. Controls <strong>core solidity</strong>.
            </li>
          </ul>
        </li>
      </ul>
    </section>

    <a href={joinURL(BASE_URL, "")}>Back to Top</a>
  </main>
</Layout>

<style>
  img {
    width: 100%;
    height: auto;
  }
</style>
