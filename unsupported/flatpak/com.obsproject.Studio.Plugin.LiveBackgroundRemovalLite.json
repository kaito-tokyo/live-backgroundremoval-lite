{
  "id": "com.obsproject.Studio.Plugin.LiveBackgroundRemovalLite",
  "branch": "stable",
  "runtime": "com.obsproject.Studio",
  "runtime-version": "stable",
  "sdk": "org.kde.Sdk//6.8",
  "build-extension": true,
  "separate-locales": false,
  "build-options": {
    "prefix": "/app/plugins/LiveBackgroundRemovalLite"
  },
  "modules": [
    {
      "name": "opencv4",
      "buildsystem": "cmake-ninja",
      "builddir": true,
      "config-opts": [
        "-D CMAKE_BUILD_TYPE=Release",
        "-D BUILD_SHARED_LIBS=ON",
        "-D OPENCV_GENERATE_PKGCONFIG=ON",
        "-D BUILD_LIST=core,imgproc,imgcodecs",
        "-D BUILD_TESTS=OFF",
        "-D BUILD_PERF_TESTS=OFF",
        "-D BUILD_EXAMPLES=OFF",
        "-D BUILD_DOCS=OFF",
        "-D BUILD_opencv_apps=OFF",
        "-D WITH_JPEG=ON",
        "-D WITH_PNG=ON",
        "-D WITH_TIFF=ON",
        "-D WITH_JASPER=OFF",
        "-D WITH_WEBP=OFF",
        "-D WITH_OPENJPEG=OFF",
        "-D WITH_OPENEXR=OFF",
        "-D WITH_FFMPEG=OFF",
        "-D WITH_GSTREAMER=OFF",
        "-D WITH_IPP=OFF",
        "-D WITH_LAPACK=OFF",
        "-D WITH_PROTOBUF=OFF",
        "-D WITH_QUIRC=OFF",
        "-D WITH_GTK=OFF",
        "-D WITH_QT=OFF",
        "-D WITH_OPENGL=OFF",
        "-D WITH_CUDA=OFF",
        "-D WITH_EIGEN=OFF"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/opencv/opencv.git",
          "tag": "4.11.0",
          "commit": "31b0eeea0b44b370fd0712312df4214d4ae1b158"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0002-install-options.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0003-force-package-requirements.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0004-fix-eigen.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0005-fix-policy-CMP0057.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0006-fix-uwp.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0008-devendor-quirc.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0009-fix-protobuf.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0010-fix-uwp-tiff-imgcodecs.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0011-remove-python2.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0012-miss-openexr.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0014-fix-cmake-in-list.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0015-fix-freetype.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0017-fix-flatbuffers.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0019-opencl-kernel.patch"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0020-fix-narrow-filesystem.diff"
        },
        {
          "type": "patch",
          "path": "patches/opencv4/0021-fix-qt-gen-def.patch"
        }
      ]
    },
    {
      "name": "ncnn",
      "buildsystem": "cmake-ninja",
      "builddir": true,
      "config-opts": [
        "-DCMAKE_BUILD_TYPE=Release",
        "-DCMAKE_INSTALL_INCLUDEDIR=include",
        "-DNCNN_SHARED_LIB=ON",
        "-DNCNN_BUILD_TESTS=OFF",
        "-DNCNN_BUILD_EXAMPLES=OFF",
        "-DNCNN_BUILD_TOOLS=OFF"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/Tencent/ncnn.git",
          "tag": "20250916",
          "commit": "c4193aadbbb56582aa87b1850dd3d98fb8fd936d"
        }
      ]
    },
    {
      "name": "live-backgroundremoval-lite",
      "buildsystem": "cmake-ninja",
      "builddir": true,
      "config-opts": [
        "-DCMAKE_BUILD_TYPE=Release",
        "-DCMAKE_PREFIX_PATH=/app/plugins/LiveBackgroundRemovalLite",
        "-DENABLE_FRONTEND_API=ON",
        "-DENABLE_QT=ON",
        "-DUSE_PKGCONFIG=ON"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/kaito-tokyo/live-backgroundremoval-lite.git",
          "tag": "2.2.0",
          "commit": "8af4badfb19b0efc19f8b0a5645584f6b7f97416",
          "x-checker-data": {
            "type": "git",
            "tag-pattern": "^([\\d.]+)$"
          }
        },
        {
          "type": "file",
          "path": "com.obsproject.Studio.Plugin.LiveBackgroundRemovalLite.metainfo.xml"
        }
      ],
      "post-install": [
        "install -Dm644 --target-directory=${FLATPAK_DEST}/share/metainfo ${FLATPAK_BUILDER_BUILDDIR}/${FLATPAK_ID}.metainfo.xml"
      ]
    }
  ],
  "cleanup": [
    "/include",
    "/lib/cmake",
    "/lib/pkgconfig"
  ]
}
